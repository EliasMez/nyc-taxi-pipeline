version: 2
models:
  - name: weekly_analysis
    description: "Weekly aggregation of trip metrics and revenue trends."
    columns:
      - name: week_start
        description: "First day of the week (Monday)."
        tests:
          - not_null
          - unique
      - name: trip_count
        description: "Total number of trips in this week."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
      - name: total_revenue
        description: "Total revenue generated in this week."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
      - name: avg_revenue
        description: "Average revenue per trip in this week."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
      - name: avg_distance
        description: "Average trip distance in this week."
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
      - name: avg_duration
        description: "Average trip duration in minutes in this week."
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
      - name: avg_tip
        description: "Average tip amount in this week."
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
      - name: avg_tip_pct
        description: "Average tip percentage in this week."
        tests:
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0