version: 2
models:
  - name: dim_time
    description: "Time dimension derived from the timestamps of the staging table."
    columns:
      - name: time_key
        description: "Unique surrogate key for the time dimension (format HH24MISS as integer)."
        tests:
          - unique
          - not_null
      - name: trip_time
        description: "Actual time (hour, minute, second) when the trip occurred."
        tests:
          - unique
          - not_null
      - name: hour
        description: "Hour extracted from the trip time (0 to 23)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 23
      - name: minute
        description: "Minute extracted from the trip time (0 to 59)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 59
      - name: second
        description: "Second extracted from the trip time (0 to 59)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 59