version: 2
models:
  - name: dim_date
    description: "Date dimension derived from the timestamps of the staging table."
    columns:
      - name: date_key
        description: "Unique surrogate key for the date dimension (format YYYYMMDD as integer)."
        tests:
          - unique
          - not_null
      - name: trip_date
        description: "Actual calendar date when the taxi trip occurred."
        tests:
          - unique
          - not_null
      - name: year
        description: "Year extracted from the trip date."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 2000
                max_value: 2100
      - name: month
        description: "Month extracted from the trip date (1 to 12)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 1
                max_value: 12
      - name: day
        description: "Day of the month extracted from the trip date (1 to 31)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 1
                max_value: 31
      - name: quarter
        description: "Calendar quarter extracted from the trip date (1 to 4)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 1
                max_value: 4
      - name: day_of_week
        description: "Day of the week extracted from the trip date (0 = Sunday, 6 = Saturday)."
        tests:
          - not_null
          - dbt_utils.accepted_range:
              arguments:
                min_value: 0
                max_value: 6
      - name: day_type
        description: "Indicates whether the trip date is a 'Weekday' or 'Weekend'."
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Weekday', 'Weekend']
      - name: month_name
        description: "Abbreviated name of the month (e.g., 'Jan')."
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
      - name: day_name
        description: "Abbreviated name of the day of the week (e.g., 'Mon')."
        tests:
          - not_null
          - accepted_values:
              arguments:
                values: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']