version: 2
models:
  - name: fact_trips
    description: "Fact table linking dimensions (time, date, location) to trip metrics."
    columns:
      - name: pickup_date_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_date')
                field: date_key
      - name: dropoff_date_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_date')
                field: date_key
      - name: pickup_time_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_time')
                field: time_key
      - name: dropoff_time_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_time')
                field: time_key
      - name: pickup_location_id
        tests:
          - relationships:
              arguments:
                to: ref('dim_locations')
                field: location_id
      - name: dropoff_location_id
        tests:
          - relationships:
              arguments:
                to: ref('dim_locations')
                field: location_id
      - name: trip_distance
        tests:
          - not_null
      - name: fare_amount
        tests:
          - not_null
      - name: tip_amount
        tests:
          - not_null
      - name: total_amount
        tests:
          - not_null
      - name: passenger_count