version: 2

models:
  - name: fact_trips
    description: "Table de faits reliant les dimensions (temps, date, lieu) aux mesures de trajets."
    columns:
      - name: pickup_date_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_date')
                field: date_key
      - name: dropoff_date_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_date')
                field: date_key
      - name: pickup_time_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_time')
                field: time_key
      - name: dropoff_time_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_time')
                field: time_key
      - name: pickup_location_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_locations')
                field: location_key
      - name: dropoff_location_key
        tests:
          - relationships:
              arguments:
                to: ref('dim_locations')
                field: location_key
      - name: trip_distance
        tests:
          - not_null
      - name: fare_amount
        tests:
          - not_null
      - name: tip_amount
        tests:
          - not_null
      - name: total_amount
        tests:
          - not_null
      - name: passenger_count
